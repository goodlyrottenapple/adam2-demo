(this["webpackJsonpadam2-demo"]=this["webpackJsonpadam2-demo"]||[]).push([[0],{105:function(e,t,a){e.exports=a(162)},162:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(17),c=a.n(o),i=a(19),l=a(20),s=a(22),d=a(21),u=a(102),m=a(12),p=a(9),h=a(58),v=a(46),f=a(11),g=a(179),b=a(180),E=a(5);function O(){var e=Object(v.a)(["\n  margin: ","px ","px;\n  padding-bottom: ","px;\n"]);return O=function(){return e},e}var y=f.default.div(O(),4*Object(E.d)(),8*Object(E.d)(),3*Object(E.d)()),C=function(e){var t=e.children;return r.a.createElement(g.a,null,r.a.createElement(b.a,null,r.a.createElement(y,null,t)))};function j(){var e=Object(v.a)(["\n  margin-bottom: ","px;\n"]);return j=function(){return e},e}var D=f.default.h1(j(),2*Object(E.d)()),_=a(35),N=a(172),T=a(175),S=a(173),A=a(91),I=a.n(A),R=a(174),P=["UNKNOWN","DISCOVERY","ACCESS","DISCOVERY_AND_ACCESS"],x=function(e){Object(s.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={data:e.props.data?e.props.data:{sharingMode:P[0]}},e.handleChange=function(t){return function(a){var n=Object(p.a)({},e.state.data);n[t]=a.value,e.setState({data:n}),e.props.setData(n)}},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.props.setData(this.state.data)}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(g.a,null,r.a.createElement(b.a,null,r.a.createElement("h5",{style:{paddingBottom:"0.5em"}},"Sharing mode:"),r.a.createElement(S.a,{className:"single-select",classNamePrefix:"react-select",menuPortalTarget:document.body,styles:{menuPortal:function(e){return Object(p.a)(Object(p.a)({},e),{},{zIndex:9999})}},options:P.map((function(e){return{label:e,value:e}})),defaultValue:{label:this.state.data.sharingMode,value:this.state.data.sharingMode},onChange:this.handleChange("sharingMode")}))))}}]),a}(r.a.Component),k=a(177),M=["UNKNOWN","DATABASE","METADATA","SUMMARISED","DATASET","RECORDSET","RECORD","RECORDFIELD"],B=function(e){Object(s.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={data:e.props.data?e.props.data:{resourceName:"",resourceDescription:"",resourceDataLevel:M[0]}},e.handleChange=function(t){return function(a){var n=Object(p.a)({},e.state.data);n[t]="resourceDataLevel"===t?a.value:a.target.value,e.setState({data:n}),e.props.setData(n)}},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.props.setData(this.state.data)}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(g.a,null,r.a.createElement(b.a,{medium:4},r.a.createElement("h5",{style:{paddingBottom:"0.5em"}},"Resource name:"),r.a.createElement(k.a,{name:"resourceName",defaultValue:this.state.data.resourceName,onChange:this.handleChange("resourceName")})),r.a.createElement(b.a,{medium:5},r.a.createElement("h5",{style:{paddingBottom:"0.5em"}},"Data level:"),r.a.createElement(S.a,{className:"single-select",classNamePrefix:"react-select",menuPortalTarget:document.body,styles:{menuPortal:function(e){return Object(p.a)(Object(p.a)({},e),{},{zIndex:9999})}},options:M.map((function(e){return{label:e,value:e}})),defaultValue:{label:this.state.data.resourceDataLevel,value:this.state.data.resourceDataLevel},onChange:this.handleChange("resourceDataLevel")}))),r.a.createElement("div",{style:{paddingTop:"1.5em"}},r.a.createElement(g.a,null,r.a.createElement(b.a,{medium:12},r.a.createElement("h5",{style:{paddingBottom:"0.5em"}},"Description:"),r.a.createElement(k.a,{name:"resourceDescription",defaultValue:this.state.data.resourceDescription,onChange:this.handleChange("resourceDescription")})))))}}]),a}(r.a.Component),L=function(e){Object(s.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={data:e.props.data?e.props.data:{resourceContactNames:[{name:"",email:""}]}},e.handleChange=function(t){return function(a){var n=Object(p.a)({},e.state.data);n.resourceContactNames[0][t]=a.target.value,e.setState({data:n}),e.props.setData(n)}},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.props.setData(this.state.data)}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(g.a,null,r.a.createElement(b.a,{medium:4},r.a.createElement("h5",{style:{paddingBottom:"0.5em"}},"Name:"),r.a.createElement(k.a,{name:"name",defaultValue:this.state.data.resourceContactNames[0].name,onChange:this.handleChange("name")})),r.a.createElement(b.a,{medium:5},r.a.createElement("h5",{style:{paddingBottom:"0.5em"}},"Email:"),r.a.createElement(k.a,{name:"email",defaultValue:this.state.data.resourceContactNames[0].email,onChange:this.handleChange("email")}))))}}]),a}(r.a.Component),H=["UNKNOWN","NO_CONSTRAINTS","CONSTRAINTS","FORBIDDEN"],V={ResourceProperties:{type:B,label:"Resource properties",canHaveChildren:!1},Contact:{type:L,label:"Contact",canHaveChildren:!1},SharingMode:{type:x,label:"Sharing mode",canHaveChildren:!1},Term:{type:function(e){Object(s.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={data:e.props.data?e.props.data:{data_use_class:null,restriction_class:{restriction_rule:"UNKNOWN",restriction_object:null,constraints_detals:""}}},e.handleChange=function(t){return function(a){var n=Object(p.a)({},e.state.data);"constraints_details"===t?n.restriction_class[t]=a.target.value:"restriction_rule"===t||"restriction_object"===t?n.restriction_class[t]=a.value:n[t]=a.value,e.setState({data:n}),e.props.setData(n)}},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.props.setData(this.state.data)}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(g.a,null,r.a.createElement(b.a,{medium:12},r.a.createElement("h5",{style:{paddingBottom:"0.5em"}},"Data use class:"),r.a.createElement(S.a,{className:"single-select",classNamePrefix:"react-select",menuPortalTarget:document.body,styles:{menuPortal:function(e){return Object(p.a)(Object(p.a)({},e),{},{zIndex:9999})}},options:["dummy1","dummy2"].map((function(e){return{label:e,value:e}})),defaultValue:{label:this.state.data.data_use_class,value:this.state.data.data_use_class},onChange:this.handleChange("data_use_class")}))),r.a.createElement("div",{style:{paddingTop:"1.5em"}},r.a.createElement(g.a,null,r.a.createElement(b.a,{medium:5},r.a.createElement("h5",{style:{paddingBottom:"0.5em"}},"Restriction rule:"),r.a.createElement(S.a,{className:"single-select",classNamePrefix:"react-select",menuPortalTarget:document.body,styles:{menuPortal:function(e){return Object(p.a)(Object(p.a)({},e),{},{zIndex:9999})}},options:H.map((function(e){return{label:e,value:e}})),defaultValue:{label:this.state.data.restriction_class.restriction_rule,value:this.state.data.restriction_class.restriction_rule},onChange:this.handleChange("restriction_rule")})),r.a.createElement(b.a,{medium:5},r.a.createElement("h5",{style:{paddingBottom:"0.5em"}},"Restriction object:"),r.a.createElement(S.a,{className:"single-select",classNamePrefix:"react-select",menuPortalTarget:document.body,styles:{menuPortal:function(e){return Object(p.a)(Object(p.a)({},e),{},{zIndex:9999})}},options:["dummy1","dummy2"].map((function(e){return{label:e,value:e}})),defaultValue:{label:this.state.data.restriction_class.restriction_object,value:this.state.data.restriction_class.restriction_object},onChange:this.handleChange("restriction_object")})),r.a.createElement(b.a,{medium:4},r.a.createElement("h5",{style:{paddingBottom:"0.5em"}},"Constraints details:"),r.a.createElement(k.a,{name:"resourceName",defaultValue:this.state.data.restriction_class.constraints_details,onChange:this.handleChange("constraints_details")})))))}}]),a}(r.a.Component),label:"Term",canHaveChildren:!0,childrenType:["Term"],rootNesting:function(e){return{terms:[e]}}}},W=Object.keys(V).filter((function(e){return"type"in V[e]})).map((function(e){return{value:e,label:V[e].label,canHaveChildren:V[e].canHaveChildren,childrenType:V[e].childrenType,rootNesting:V[e].rootNesting}})),w=function(e){Object(s.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(e=t.call.apply(t,[this].concat(o))).state={counter:0,tree:{rootId:"root",items:{root:{id:"root",children:[],hasChildren:!0,isExpanded:!0,isChildrenLoading:!1,canHaveChildren:!0}}}},e.storeData=function(t){return function(a){var n=Object(p.a)({},e.state.tree);n.items[t].data=a,e.setState({tree:n})}},e.renderBuilderFromTreeItem=function(t){var a=V[t.type].type;return r.a.createElement(a,{setData:e.storeData(t.id),data:t.data,label:V[t.type].label,settings_id:e.props.match.params.id})},e.renderItem=function(t){var a=t.item,n=(t.onExpand,t.onCollapse,t.provided);return r.a.createElement("div",Object.assign({ref:n.innerRef},n.draggableProps,n.dragHandleProps),r.a.createElement("div",{style:{backgroundColor:"white",borderColor:"rgb(222, 235, 255)",borderRadius:"3px",borderWidth:"2px",borderStyle:"solid",padding:"10px",marginTop:"5px"}},r.a.createElement(g.a,{spacing:"compact"},r.a.createElement(b.a,{medium:1},r.a.createElement(T.a,{appearance:"subtle",spacing:"none",onClick:function(){return e.onDelete(a.id)}},r.a.createElement(I.a,null))),r.a.createElement(b.a,{medium:11},e.renderBuilderFromTreeItem(a)))))},e.createTreeItem=function(e,t,a,n,r){return{id:e,children:[],hasChildren:!1,isExpanded:!1,isChildrenLoading:!1,canHaveChildren:a,childrenType:n,rootNesting:r,type:t}},e.addItemToRoot=function(t,a,n,r,o,c){var i=Object(p.a)({},t.items);return i["".concat(a)]=e.createTreeItem(a,n,r,o,c),i.root.children.push("".concat(a)),{rootId:t.rootId,items:i}},e.deleteItem=function(e,t){var a=Object(p.a)({},e.items);delete a["".concat(t)];for(var n=0,r=Object.keys(a);n<r.length;n++){var o=r[n];a[o].children.includes("".concat(t))&&a[o].children.splice(a[o].children.indexOf("".concat(t)),1)}return{rootId:e.rootId,items:a}},e.onDelete=function(t){var a=e.state,n=(a.counter,a.tree),r=a.queries,o=e.deleteItem(n,t);delete Object(p.a)({},r)[t],e.setState({tree:o})},e.onDragEnd=function(t,a){var n=e.state.tree;if(a&&(console.log(n.items[n.items[t.parentId].children[t.index]].type),n.items[a.parentId].canHaveChildren&&(!n.items[a.parentId].childrenType||n.items[a.parentId].childrenType.includes(n.items[n.items[t.parentId].children[t.index]].type)))){var r=Object(_.c)(n,t,a);e.setState({tree:Object(_.d)(r,a.parentId,{isExpanded:!0})})}},e.handleChange=function(t){var a=e.state,n=a.counter,r=a.tree,o=e.addItemToRoot(r,n,t.value,t.canHaveChildren,t.childrenType,t.rootNesting);e.setState({counter:n+1,tree:o})},e.saveTree=function(){fetch(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_API_URL+"/discovery/saveSettings",{method:"POST",headers:{"Access-Control-Allow-Origin":"*","Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({id:e.props.match.params.id,data:e.state.tree})}).then((function(e){return e.json()})).then((function(e){console.log(e)}),(function(e){console.log(e)}))},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;fetch(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_API_URL+"/discovery/loadSettings?id="+this.props.match.params.id,{headers:{"Access-Control-Allow-Origin":"*","Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest"}}).then((function(e){return e.json()})).then((function(t){if(t){for(var a,n=JSON.parse(t),r=Object.keys(n.items),o=0,c=0;c<r.length;c++)(a=parseInt(r[c]))>o&&(o=a);e.setState({tree:n,counter:o+1})}}),(function(t){e.setState({error:t})}))}},{key:"mkADAM",value:function(e){return function e(t,a){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return a.map((function(a){var r=e(t,t.items[a].children),o=t.items[a].children>0?Object(p.a)(Object(p.a)({},t.items[a].data),{},{child_terms:r}):t.items[a].data;return n&&t.items[a].rootNesting?t.items[a].rootNesting(o):o}))}(e,e.items.root.children,!0).reduce((function(e,t){return function e(t,a){if(void 0===t)return a;if(void 0===a)return t;switch(typeof t){case"object":if(Array.isArray(t))return Array.isArray(a)?[].concat(Object(h.a)(t),Object(h.a)(a)):[].concat(Object(h.a)(t),[a]);var n={};for(var r in t)void 0===a[r]?n[r]=t[r]:n[r]=e(t[r],a[r]);for(var r in a)void 0===t[r]&&(n[r]=a[r]);return n;default:return t}}(e,t)}),{})}},{key:"render",value:function(){var e=this.state.tree;return r.a.createElement(C,null,r.a.createElement(D,null,"ADA-M 2.0 demo"),r.a.createElement(N.a,{tree:e,renderItem:this.renderItem,onDragEnd:this.onDragEnd,offsetPerLevel:30,isDragEnabled:!0,isNestingEnabled:!0}),r.a.createElement("div",{style:{marginTop:"100px"}},r.a.createElement(S.a,{options:W,onChange:this.handleChange,placeholder:"Select a property to add"})),r.a.createElement("div",{style:{marginTop:"20px"}}),r.a.createElement("h4",{style:{paddingTop:"30px",paddingBottom:"10px"}},"ADA-M:"),r.a.createElement(R.a,{language:"json",text:JSON.stringify(this.mkADAM(this.state.tree),null,2),showLineNumbers:!1}))}}]),a}(n.Component),U=(a(158),a(159),a(160),function(e){Object(s.a)(a,e);var t=Object(d.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return r.a.createElement(u.a,{basename:""},r.a.createElement(m.c,null,r.a.createElement(m.a,{path:"/",component:w})))}}]),a}(n.Component));c.a.render(r.a.createElement(U,null),document.getElementById("app-root"))}},[[105,152,153]]]);
//# sourceMappingURL=main.5ae0c24f.chunk.js.map